# 윷놀이 게임 프로젝트 다이어그램 모음

이 파일은 졸업작품 보고서에 포함된 모든 Mermaid 다이어그램을 모아놓은 파일입니다.

---

## 1. Android Studio - Circuit Diagram

Android Studio에서 구현된 Unity 연동 시스템의 구조입니다.

```mermaid
graph TB
    A[Unity Game] <-->|Unity-Android Bridge| B[Android Native Bridge]
    B <-->|Firebase SDK| C[Firebase Realtime Database]
    C <-->|Network| D[Remote Player Device]
    
    style A fill:#e1f5ff
    style B fill:#fff4e1
    style C fill:#ffe1f5
    style D fill:#e1ffe1
```

---

## 2. Android Studio - Flow Chart

게임 플레이 흐름도입니다.

```mermaid
flowchart TD
    A[게임 시작] --> B[Firebase 연결]
    B --> C[게임 방 생성/참가]
    C --> D[게임 상태 동기화 시작]
    D --> E[플레이어 액션 발생]
    E --> F[Firebase에 상태 업데이트]
    F --> G[상태 변경 리스너 트리거]
    G --> H[Unity로 상태 전달]
    H --> I[게임 화면 업데이트]
    I --> J{게임 종료?}
    J -->|아니오| E
    J -->|예| K[게임 종료]
    
    style A fill:#e1f5ff
    style K fill:#ffe1e1
```

---

## 3. Unity - Class Diagram

Unity 프로젝트의 주요 클래스 구조입니다.

```mermaid
classDiagram
    class YutGameManager {
        +PlayerController[] players
        +Transform[] boardPositions
        +YutTurnManager turnManager
        +YutPlatformManager platformManager
        +YutHorseManager horseManager
        +YutInputHandler inputHandler
        +YutMovementManager movementManager
        +YutSelectionHandler selectionHandler
        +YutThrowController yutThrowController
        +int currentTurnIndex
        +int[] playerPositions
        +void ThrowYut()
        +void ChangeTurn()
        +void UpdateUI()
    }
    
    class YutTurnManager {
        -YutGameManager gameManager
        -List~YutOutcome~ pendingMovements
        +IEnumerator ThrowAndMoveSequence()
        +void Initialize()
    }
    
    class YutPlatformManager {
        +Transform[] boardPositions
        +Material goldenPlatformMaterial
        +void SelectRandomGoldenPlatform()
        +void ShowSelectablePlatforms()
    }
    
    class YutHorseManager {
        +PlayerController[] players
        +void UpdateHorseCountUI()
        +void RefreshHorsesAtPosition()
        +Vector3 CalculateHorsePosition()
    }
    
    class YutInputHandler {
        +void Initialize()
        +void HandleInput()
    }
    
    class YutMovementManager {
        +IEnumerator MoveHorse()
        +IEnumerator MoveToSelectedPlatform()
    }
    
    class YutSelectionHandler {
        +void OnHorseSelected()
        +void OnPlatformSelected()
    }
    
    class YutThrowController {
        +Rigidbody[] yutSticks
        +IEnumerator ThrowAndWait()
        +YutOutcome CalculateOutcome()
    }
    
    class PlayerController {
        +NavMeshAgent agent
        +float moveSpeed
        +void MoveToPosition()
        +bool HasReachedDestination()
    }
    
    class YutGameUtils {
        +int GetMoveSteps()
        +string OutcomeToKorean()
        +Vector3 GetValidNavMeshPosition()
    }
    
    YutGameManager --> YutTurnManager
    YutGameManager --> YutPlatformManager
    YutGameManager --> YutHorseManager
    YutGameManager --> YutInputHandler
    YutGameManager --> YutMovementManager
    YutGameManager --> YutSelectionHandler
    YutGameManager --> YutThrowController
    YutGameManager --> PlayerController
    YutGameManager ..> YutGameUtils
    YutMovementManager --> PlayerController
    PlayerController --> NavMeshAgent
```

---

## 4. Unity - Sequence Diagram

게임 플레이 중 윷 던지기 및 말 이동 시퀀스입니다.

```mermaid
sequenceDiagram
    participant Player
    participant YutGameManager
    participant YutTurnManager
    participant YutThrowController
    participant Physics
    participant YutHorseManager
    participant YutInputHandler
    participant YutSelectionHandler
    participant YutPlatformManager
    participant YutMovementManager
    participant PlayerController
    participant NavMeshAgent
    
    Player->>YutGameManager: ThrowYut() 호출
    YutGameManager->>YutTurnManager: ThrowAndMoveSequence() 시작
    YutTurnManager->>YutThrowController: ThrowAndWait()
    YutThrowController->>Physics: 윷 던지기 (물리 시뮬레이션)
    Physics-->>YutThrowController: 물리 시뮬레이션 완료
    YutThrowController->>YutThrowController: 결과 판정
    YutThrowController-->>YutTurnManager: 결과 반환
    YutTurnManager->>YutGameManager: 결과 처리
    YutGameManager->>YutHorseManager: 이동 가능한 말 표시
    Player->>YutInputHandler: 말 선택
    YutInputHandler->>YutSelectionHandler: OnHorseSelected()
    YutSelectionHandler->>YutGameManager: 말 선택 완료
    YutGameManager->>YutPlatformManager: 이동 가능한 발판 표시
    Player->>YutInputHandler: 발판 선택
    YutInputHandler->>YutSelectionHandler: OnPlatformSelected()
    YutSelectionHandler->>YutMovementManager: MoveToSelectedPlatform()
    YutMovementManager->>PlayerController: MoveToPosition()
    PlayerController->>NavMeshAgent: 이동 시작
    NavMeshAgent-->>PlayerController: 이동 완료
    PlayerController-->>YutGameManager: 이동 완료 알림
    YutGameManager->>YutTurnManager: 턴 종료 또는 계속
```

---

## 5. Firebase - Class Diagram

Firebase 연동을 위한 클래스 구조입니다.

```mermaid
classDiagram
    class FirebaseManager {
        -FirebaseDatabase database
        -FirebaseAuth auth
        -GameStateSync gameStateSync
        +void Initialize()
        +void CreateGameRoom()
        +void JoinGameRoom()
        +void LeaveGameRoom()
    }
    
    class FirebaseDatabase {
        +DatabaseReference GetReference()
        +void SetValue()
        +void AddValueEventListener()
    }
    
    class FirebaseAuth {
        +void SignIn()
        +void SignOut()
        +User GetCurrentUser()
    }
    
    class GameStateSync {
        -DatabaseReference gameRef
        +void SendGameState()
        +void OnGameStateChanged()
        +void UpdateGameState()
    }
    
    class NetworkThread {
        -IEnumerator networkCoroutine
        +IEnumerator ProcessNetworkData()
        +void StartListening()
    }
    
    class UnityFirebaseBridge {
        -FirebaseManager firebaseManager
        +void SendGameState()
        +void ReceiveGameState()
        +void OnStateChanged()
    }
    
    FirebaseManager --> FirebaseDatabase
    FirebaseManager --> FirebaseAuth
    FirebaseManager --> GameStateSync
    NetworkThread ..> Unity Coroutine
    UnityFirebaseBridge --> FirebaseManager
    GameStateSync --> NetworkThread
```

---

## 6. Firebase - Sequence Diagram

Firebase를 통한 실시간 멀티플레이어 시퀀스입니다.

```mermaid
sequenceDiagram
    participant P1 as Player 1
    participant Unity1 as Unity (Player 1)
    participant FB1 as FirebaseBridge
    participant FM as FirebaseManager
    participant DB as Firebase Realtime DB
    participant NT1 as NetworkThread (P1)
    participant GM1 as YutGameManager (P1)
    participant UI1 as UI (P1)
    
    participant P2 as Player 2
    participant Unity2 as Unity (Player 2)
    participant FB2 as FirebaseBridge
    participant NT2 as NetworkThread (P2)
    participant GM2 as YutGameManager (P2)
    participant UI2 as UI (P2)
    
    Note over P1,UI1: Player 1의 액션
    P1->>Unity1: 게임 액션 수행
    Unity1->>FB1: 게임 상태 변경
    FB1->>FM: SendGameState()
    FM->>DB: 상태 업데이트
    DB->>NT2: 상태 변경 이벤트
    NT2->>FM: 상태 변경 감지
    FM->>FB2: ReceiveGameState()
    FB2->>Unity2: 상태 업데이트
    Unity2->>GM2: 상대방 액션 반영
    GM2->>UI2: 화면 업데이트
    
    Note over P2,UI2: Player 2의 액션
    P2->>Unity2: 게임 액션 수행
    Unity2->>FB2: 게임 상태 변경
    FB2->>FM: SendGameState()
    FM->>DB: 상태 업데이트
    DB->>NT1: 상태 변경 이벤트
    NT1->>FM: 상태 변경 감지
    FM->>FB1: ReceiveGameState()
    FB1->>Unity1: 상태 업데이트
    Unity1->>GM1: 상대방 액션 반영
    GM1->>UI1: 화면 업데이트
```

---

## 사용 방법

이 파일의 Mermaid 다이어그램은 다음 환경에서 렌더링됩니다:

- GitHub / GitLab (마크다운 뷰어)
- VS Code (Mermaid 확장 설치 시)
- Mermaid Live Editor (https://mermaid.live/)
- Notion, Obsidian 등 Mermaid를 지원하는 에디터

각 다이어그램은 독립적으로 사용할 수 있으며, 보고서에 포함하거나 별도 문서로 활용할 수 있습니다.

